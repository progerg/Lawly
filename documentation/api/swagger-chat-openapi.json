{"openapi":"3.1.0","info":{"title":"Lawly Chat API","version":"0.1.0"},"paths":{"/api/v1/chat/ai/messages":{"get":{"tags":["AI-помощник"],"summary":"Получение сообщений из чата с AI","description":"Получение сообщений из чата с AI-помощником с фильтрацией по датам.\n\nПозволяет получить историю сообщений с AI-помощником с применением фильтров:\n- Начальная дата (опционально)\n- Конечная дата (опционально)\n- Лимит сообщений (опционально, по умолчанию 50)\n- Смещение для пагинации (опционально, по умолчанию 0)\n\nТребуется авторизация с помощью JWT токена.","operationId":"get_messages_api_v1_chat_ai_messages_get","security":[{"JWTBearer":[]}],"parameters":[{"name":"from_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Начальная дата для выборки сообщений (включительно)","title":"From Date"},"description":"Начальная дата для выборки сообщений (включительно)"},{"name":"to_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Конечная дата для выборки сообщений (включительно)","title":"To Date"},"description":"Конечная дата для выборки сообщений (включительно)"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","description":"Максимальное количество сообщений","default":50,"title":"Limit"},"description":"Максимальное количество сообщений"},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","description":"Смещение для пагинации","default":0,"title":"Offset"},"description":"Смещение для пагинации"}],"responses":{"200":{"description":"История сообщений","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessagesResponseDTO"}}}},"409":{"description":"Нет активной подписки с такими функциями"},"403":{"description":"Доступ запрещен"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["AI-помощник"],"summary":"Отправка сообщения AI-помощнику","description":"Отправка нового сообщения в чат с AI-помощником.\n\nПозволяет отправить текстовое сообщение AI-помощнику и получить ответ.\n\nТребуется авторизация с помощью JWT токена и активная подписка.","operationId":"send_message_api_v1_chat_ai_messages_post","security":[{"JWTBearer":[]}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageRequestDTO"}}}},"responses":{"202":{"description":"Сообщение успешно отправлено"},"400":{"description":"Что-то пошло не так при добавлении в очередь"},"409":{"description":"Нет активной подписки с такими функциями"},"403":{"description":"Доступ запрещен"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/lawyer/messages":{"get":{"tags":["Юридические консультации"],"summary":"Получение сообщений из чата с юристом","description":"Получение сообщений из чата с юристом с фильтрацией по датам.\n\nПозволяет получить историю сообщений с юристом с применением фильтров:\n- Начальная дата (опционально)\n- Конечная дата (опционально)\n- Лимит сообщений (опционально, по умолчанию 50)\n- Смещение для пагинации (опционально, по умолчанию 0)\n\nТребуется авторизация с помощью JWT токена.","operationId":"get_messages_api_v1_chat_lawyer_messages_get","security":[{"JWTBearer":[]}],"parameters":[{"name":"from_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Начальная дата для выборки сообщений (включительно)","title":"From Date"},"description":"Начальная дата для выборки сообщений (включительно)"},{"name":"to_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Конечная дата для выборки сообщений (включительно)","title":"To Date"},"description":"Конечная дата для выборки сообщений (включительно)"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","description":"Максимальное количество сообщений","default":50,"title":"Limit"},"description":"Максимальное количество сообщений"},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","description":"Смещение для пагинации","default":0,"title":"Offset"},"description":"Смещение для пагинации"}],"responses":{"200":{"description":"История сообщений","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessagesResponseDTO"}}}},"401":{"description":"Не авторизован"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/chat/lawyer/request":{"post":{"tags":["Юридические консультации"],"summary":"Создание обращения к юристу","description":"Создание нового обращения к юристу для консультации.\n\nПозволяет создать запрос на консультацию к юристу с опциональным приложением документа.\n\nТребуется авторизация с помощью JWT токена. Доступность консультаций определяется наличием\nи типом подписки пользователя.","operationId":"create_request_api_v1_chat_lawyer_request_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LawyerRequestDTO"}}},"required":true},"responses":{"201":{"description":"Обращение успешно создано","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MessageResponseDTO"}}}},"401":{"description":"Не авторизован"},"403":{"description":"Доступ запрещен (нет подписки или исчерпан лимит консультаций)"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"JWTBearer":[]}]}}},"components":{"schemas":{"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LawyerRequestDTO":{"properties":{"message":{"type":"string","title":"Message","example":"Необходима консультация по вопросу возврата товара."},"document_url":{"anyOf":[{"type":"string","maxLength":2083,"minLength":1,"format":"uri"},{"type":"null"}],"title":"Document Url","description":"Ссылка на документ в S3, если обращение связано с проверкой документа","example":"https://storage.example.com/documents/doc-12345.pdf"}},"type":"object","required":["message"],"title":"LawyerRequestDTO"},"MessageRequestDTO":{"properties":{"content":{"type":"string","title":"Content","example":"Как мне составить претензию на возврат товара?"}},"type":"object","required":["content"],"title":"MessageRequestDTO"},"MessageResponseDTO":{"properties":{"id":{"type":"string","title":"Id","example":"msg-12345"},"sender_type":{"type":"string","title":"Sender Type","description":"Тип отправителя: user, ai, lawyer","example":"user"},"sender_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sender Id","description":"ID отправителя (для юристов)","example":"user-123"},"sender_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Sender Name","description":"Имя отправителя (для юристов)","example":"Иванов И.И."},"content":{"type":"string","title":"Content","example":"Как мне составить претензию на возврат товара?"},"created_at":{"type":"string","format":"date-time","title":"Created At","example":"2023-01-15T12:00:00Z"},"status":{"type":"string","title":"Status","description":"Статус сообщения: sent, delivered, read","example":"delivered"}},"type":"object","required":["id","sender_type","content","created_at","status"],"title":"MessageResponseDTO"},"MessagesResponseDTO":{"properties":{"total":{"type":"integer","title":"Total","description":"Общее количество сообщений в выбранном диапазоне","example":45},"has_more":{"type":"boolean","title":"Has More","description":"Флаг наличия дополнительных сообщений","example":true},"messages":{"items":{"$ref":"#/components/schemas/MessageResponseDTO"},"type":"array","title":"Messages","description":"Список сообщений"}},"type":"object","required":["total","has_more","messages"],"title":"MessagesResponseDTO"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"JWTBearer":{"type":"http","scheme":"bearer"}}}}